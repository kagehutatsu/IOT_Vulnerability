# Ruijie RG-EW1200 RCE Vulnerability

- website: https://www.ruijienetworks.com/
- flash download: https://www.ruijienetworks.com/support/documents/slide_77459
- test on: Ruijie RG-EW1200, Ruijie RG-EW1200G PRO

## Vulnerability Details

Function setSysTime in /usr/lib/lua/luci/module/common.lua

![Screenshot_20230217_001105](img/Screenshot_20230217_001105.png)

Variable params.force will be spliced directly with a check.

<img src="img/Screenshot_20230217_153044.png" alt="Screenshot_20230217_153044" style="zoom:125%;" />

Check Function can be bypassed by character '\u000A'

And There is a command injection vulnerability.

Poc:

![Screenshot_20230217_152204](img/Screenshot_20230217_152204.png)

Result:

![Screenshot_20230217_152156](img/Screenshot_20230217_152156.png)