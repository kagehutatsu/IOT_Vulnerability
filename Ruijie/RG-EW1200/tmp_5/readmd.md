# Ruijie RG-EW1200 RCE Vulnerability

- website: https://www.ruijienetworks.com/
- flash download: https://www.ruijienetworks.com/support/documents/slide_77459

## Vulnerability Details

In /usr/lib/lua/luci/module/cmd.lua

![Screenshot_20230217_150534](img/Screenshot_20230217_150534.png)

![Screenshot_20230217_150346](img/Screenshot_20230217_150346.png)

Variable param.data is sended to next function as new param.

And In /usr/lib/lua/dev_config.lua.

![Screenshot_20230217_145413](img/Screenshot_20230217_145413.png)

if cmd is "set", it will call function call_module_commit.

And in function call_module_commit.

![Screenshot_20230217_145106](img/Screenshot_20230217_145106.png)

param will be spliced directly without any check.

And There is a command injection vulnerability.

Poc:

![Screenshot_20230217_145803](img/Screenshot_20230217_145803.png)

Result:

![Screenshot_20230217_145756](img/Screenshot_20230217_145756.png)