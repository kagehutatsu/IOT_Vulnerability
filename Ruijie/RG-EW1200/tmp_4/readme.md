# Ruijie RG-EW1200 RCE Vulnerability

- website: https://www.ruijienetworks.com/
- flash download: https://www.ruijienetworks.com/support/documents/slide_77459

## Vulnerability Details

Function startCheck in /usr/lib/lua/luci/module/cmd.lua

![Screenshot_20230217_001129](img/Screenshot_20230217_001129.png)

Variables params.isLanPing and params.isWanPing will be spliced directly with a check.

<img src="img/Screenshot_20230217_154331.png" alt="Screenshot_20230217_154331" style="zoom:125%;" />

Check Function can be bypassed by character '\u000A'

And There is a command injection vulnerability.

Poc:

![Screenshot_20230217_152405](img/Screenshot_20230217_152405.png)

Result:

![Screenshot_20230217_152501](img/Screenshot_20230217_152501.png)