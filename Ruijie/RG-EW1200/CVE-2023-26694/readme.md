# Ruijie RG-EW Series Routers RCE Vulnerability

- website: https://www.ruijienetworks.com/
- flash download: https://www.ruijienetworks.com/support/documents/slide_77459
- test on: Ruijie RG-EW1200, Ruijie RG-EW1200G PRO

## Vulnerability Details

Function allConf in /usr/lib/lua/luci/module/common.lua

<img src="img/Screenshot_20230217_000954.png" alt="Screenshot_20230217_000954" style="zoom:125%;" />

Variable params.search will be spliced directly without any check.

And There is a command injection vulnerability.

Poc:

![Screenshot_20230217_152036](img/Screenshot_20230217_152036.png)

Result:

![Screenshot_20230217_152028](img/Screenshot_20230217_152028.png)