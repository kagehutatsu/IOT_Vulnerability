# Ruijie RG-EW1200 RCE Vulnerability

- website: https://www.ruijienetworks.com/
- flash download: https://www.ruijienetworks.com/support/documents/slide_77459
- test on: Ruijie RG-EW1200, Ruijie RG-EW1200G PRO

## Vulnerability Details

Function ping in /usr/lib/lua/luci/module/diagnose.lua

![Screenshot_20230217_001149](/home/kagehutatsu/Desktop/Github/IOT_Vulnerability/Ruijie/RG-EW1200/tmp_3/img/Screenshot_20230217_001149.png)

Variable _d.target will be spliced directly without any check.

And There is a command injection vulnerability.

(Function traceroute and nslookup have the same vulnerability too)

Poc:

![Screenshot_20230217_152303](img/Screenshot_20230217_152303.png)

Result:

![Screenshot_20230217_152256](img/Screenshot_20230217_152256.png)