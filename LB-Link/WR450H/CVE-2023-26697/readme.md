# LB-Link WR Series Routers RCE Vulnerability

- website: https://www.lb-link.cn/
- flash download: https://www.lb-link.cn/download-detail.php?DId=183
- test on WR308 and WR450H

## Vulnerability Details

Function bs_SetForwardingInfo in /lib/libshare-0.0.26.so

![Screenshot_20230216_152717](img/Screenshot_20230216_152717.png)

Variables ip, port and protocol are packed and saved to nvram_buf.

![Screenshot_20230216_151917](img/Screenshot_20230216_151917.png)

After that, it will call execute "filter -C forwarding &"

![Screenshot_20230216_151808](img/Screenshot_20230216_151808.png)

Finally, in /bin/filter, Variables will be unpacked and spliced without check

And There is a command injection without authentication vulnerability

Poc:

![Screenshot_20230216_142152](img/Screenshot_20230216_142152.png)

Result:

![Screenshot_20230216_142220](img/Screenshot_20230216_142220.png)

