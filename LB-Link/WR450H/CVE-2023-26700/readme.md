# LB-Link WR Series Routers RCE Vulnerability

- website: https://www.lb-link.cn/
- flash download: https://www.lb-link.cn/download-detail.php?DId=183
- test on WR308 and WR450H

## Vulnerability Details

Function bs_SetMacBlack in /lib/libshare-0.0.26.so

![Screenshot_20230216_154354](img/Screenshot_20230216_154354.png)

Variable mac is saved in v13

![Screenshot_20230216_154429](img/Screenshot_20230216_154429.png)

And it's formated and executed in line 151.

Although it's limit by double quotes. "`" and "$()" can bypass them easily.

Poc:

![Screenshot_20230216_142152](img/Screenshot_20230216_144221.png)

Result:

![Screenshot_20230216_142220](img/Screenshot_20230216_144242.png)

