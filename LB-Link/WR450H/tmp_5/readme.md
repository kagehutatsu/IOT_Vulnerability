# LB-Link WR Series Routers RCE Vulnerability

- website: https://www.lb-link.cn/
- flash download: https://www.lb-link.cn/download-detail.php?DId=183
- test on WR308 and WR450H

## Vulnerability Details

Function bs_SetManPwd in /lib/libshare-0.0.26.so

![Screenshot_20230216_160644](/home/kagehutatsu/Desktop/Github/IOT_Vulnerability/LB-Link/WR308/tmp_5/img/Screenshot_20230216_160644.png)

Variable routepwd is saved to nvram_buf in line 35.

And In line 53 it's formated and executed as sys_argv without check.

Finally, There is a command injection without authentication vulnerability.

Poc:

![Screenshot_20230216_160309](img/Screenshot_20230216_160309.png)

Result:

![Screenshot_20230216_145459](img/Screenshot_20230216_145459.png)
